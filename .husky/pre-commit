#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

echo "Running pre-commit checks..."

# Block .env files
if git diff --cached --name-only | grep -q "\.env$"; then
  echo " ERROR: .env file detected. Remove it before committing."
  exit 1
fi

# Block log files
if git diff --cached --name-only | grep -q "\.log$"; then
  echo " ERROR: Log files should not be committed."
  exit 1
fi

# JavaScript file check (basic)
JS_FILES=$(git diff --cached --name-only --diff-filter=ACM | grep "\.js$")

if [ -n "$JS_FILES" ]; then
  echo "Checking JavaScript files..."
  for file in $JS_FILES; do
    if [ ! -f "$file" ]; then
      continue
    fi
    # basic check: file should not be empty
    if [ ! -s "$file" ]; then
      echo "‚ùå ERROR: Empty JS file detected: $file"
      exit 1
    fi
  done
fi


echo " Pre-commit checks passed"
